From [github.com/Pimm/mapsort](https://github.com/Pimm/mapsort).